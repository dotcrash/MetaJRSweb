{"remainingRequest":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\babel-loader\\lib\\index.js!F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\HBuilderX软件\\Project\\brainHealth\\src\\views\\user\\userCenter\\components\\uploadImg.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\src\\views\\user\\userCenter\\components\\uploadImg.vue","mtime":1634182984000},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652873263289},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\babel-loader\\lib\\index.js","mtime":1652873271922},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652873263289},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\vue-loader\\lib\\index.js","mtime":1652873270400}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"F:\\\\HBuilderX\\u8F6F\\u4EF6\\\\Project\\\\brainHealth\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { uploadAvatarImgApi } from \"@/api/api\";\nexport default {\n  name: \"uploadImg\",\n  props: {\n    dialogTableVisible: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    return {\n      imgUrl: \"\",\n      showImg: true,\n      filedata: \"\"\n    };\n  },\n  methods: {\n    closeClick: function closeClick() {\n      this.$emit(\"closeUploadImg\", false);\n    },\n    getFile: function getFile(file) {\n      var _this = this;\n\n      this.$utils.getBase64(file).then(function (res) {\n        if (res) {\n          _this.showImg = false;\n          _this.imgUrl = res;\n        }\n      });\n    },\n    // 覆盖默认的上传行为，可以自定义上传的实现\n    handleUpload: function handleUpload(res) {\n      var formData = new FormData();\n      formData.append(\"avatar\", res.file);\n      formData.append(\"id\", this.$store.getters.getUser._id);\n      this.filedata = formData;\n      this.getFile(res.file);\n    },\n    //取消上传\n    cancelUpload: function cancelUpload() {\n      this.showImg = true;\n      this.imgUrl = \"\";\n    },\n    //确认上传\n    confirmUpload: function () {\n      var _confirmUpload = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return uploadAvatarImgApi(this.filedata);\n\n              case 2:\n                res = _context.sent;\n                console.log(res);\n\n                if (res.code === 200) {\n                  this.$utils.elMessageBox(\"更换头像成功\", \"success\");\n                }\n\n                this.closeClick();\n                this.$emit(\"updateImg\");\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function confirmUpload() {\n        return _confirmUpload.apply(this, arguments);\n      }\n\n      return confirmUpload;\n    }()\n  }\n};",{"version":3,"sources":["uploadImg.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAoBA,SAAA,kBAAA,QAAA,WAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,KAAA,EAAA;AACA,IAAA,kBAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,OAAA,EAAA;AAFA;AADA,GAFA;AAQA,EAAA,IARA,kBAQA;AACA,WAAA;AACA,MAAA,MAAA,EAAA,EADA;AAEA,MAAA,OAAA,EAAA,IAFA;AAGA,MAAA,QAAA,EAAA;AAHA,KAAA;AAKA,GAdA;AAeA,EAAA,OAAA,EAAA;AACA,IAAA,UADA,wBACA;AACA,WAAA,KAAA,CAAA,gBAAA,EAAA,KAAA;AACA,KAHA;AAIA,IAAA,OAJA,mBAIA,IAJA,EAIA;AAAA;;AACA,WAAA,MAAA,CAAA,SAAA,CAAA,IAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,EAAA;AACA,UAAA,KAAA,CAAA,OAAA,GAAA,KAAA;AACA,UAAA,KAAA,CAAA,MAAA,GAAA,GAAA;AACA;AACA,OALA;AAMA,KAXA;AAYA;AACA,IAAA,YAbA,wBAaA,GAbA,EAaA;AACA,UAAA,QAAA,GAAA,IAAA,QAAA,EAAA;AACA,MAAA,QAAA,CAAA,MAAA,CAAA,QAAA,EAAA,GAAA,CAAA,IAAA;AACA,MAAA,QAAA,CAAA,MAAA,CAAA,IAAA,EAAA,KAAA,MAAA,CAAA,OAAA,CAAA,OAAA,CAAA,GAAA;AACA,WAAA,QAAA,GAAA,QAAA;AACA,WAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,KAnBA;AAoBA;AACA,IAAA,YArBA,0BAqBA;AACA,WAAA,OAAA,GAAA,IAAA;AACA,WAAA,MAAA,GAAA,EAAA;AACA,KAxBA;AAyBA;AACA,IAAA,aA1BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBA2BA,kBAAA,CAAA,KAAA,QAAA,CA3BA;;AAAA;AA2BA,gBAAA,GA3BA;AA4BA,gBAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,oBAAA,GAAA,CAAA,IAAA,KAAA,GAAA,EAAA;AACA,uBAAA,MAAA,CAAA,YAAA,CAAA,QAAA,EAAA,SAAA;AACA;;AACA,qBAAA,UAAA;AACA,qBAAA,KAAA,CAAA,WAAA;;AAjCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAfA,CAAA","sourcesContent":["<template>\n  <div class=\"upload-box\">\n    <el-dialog title=\"更换头像\" @close=\"closeClick\" :visible=\"true\" :close-on-click-modal=\"false\" align=\"center\" width=\"800px\">\n      <el-upload class=\"upload-demo\" :http-request=\"handleUpload\" action :limit=\"1\" :show-file-list=\"false\" drag v-if=\"showImg\">\n        <i class=\"el-icon-upload\"></i>\n        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n        <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过1M</div>\n      </el-upload>\n      <div v-else class=\"img-box\">\n        <img :src=\"imgUrl\" alt=\"\" />\n        <div class=\"btn-box\">\n          <el-button type=\"info\" plain @click=\"cancelUpload\">取消</el-button>\n          <el-button type=\"danger\" plain @click=\"confirmUpload\">上传并保存</el-button>\n        </div>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { uploadAvatarImgApi } from \"@/api/api\";\nexport default {\n  name: \"uploadImg\",\n  props: {\n    dialogTableVisible: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      imgUrl: \"\",\n      showImg: true,\n      filedata: \"\",\n    };\n  },\n  methods: {\n    closeClick() {\n      this.$emit(\"closeUploadImg\", false);\n    },\n    getFile(file) {\n      this.$utils.getBase64(file).then((res) => {\n        if (res) {\n          this.showImg = false;\n          this.imgUrl = res;\n        }\n      });\n    },\n    // 覆盖默认的上传行为，可以自定义上传的实现\n    handleUpload(res) {\n      let formData = new FormData();\n      formData.append(\"avatar\", res.file);\n      formData.append(\"id\", this.$store.getters.getUser._id);\n      this.filedata = formData;\n      this.getFile(res.file);\n    },\n    //取消上传\n    cancelUpload() {\n      this.showImg = true;\n      this.imgUrl = \"\";\n    },\n    //确认上传\n    async confirmUpload() {\n      let res = await uploadAvatarImgApi(this.filedata);\n      console.log(res);\n      if (res.code === 200) {\n        this.$utils.elMessageBox(\"更换头像成功\", \"success\");\n      }\n      this.closeClick();\n      this.$emit(\"updateImg\");\n    },\n  },\n};\n</script>\n\n<style scoped>\n.img-box {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.img-box > img {\n  width: 240px;\n  height: 240px;\n  border-radius: 50%;\n}\n.btn-box {\n  margin-top: 30px;\n  width: 200px;\n  display: flex;\n  justify-content: space-between;\n}\n.el-upload__tip {\n  font-size: 16px;\n}\n.el-upload__text {\n  font-size: 16px;\n}\n</style>"],"sourceRoot":"src/views/user/userCenter/components"}]}