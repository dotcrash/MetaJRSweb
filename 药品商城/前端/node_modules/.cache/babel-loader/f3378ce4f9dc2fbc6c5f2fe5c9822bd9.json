{"remainingRequest":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\thread-loader\\dist\\cjs.js!F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\babel-loader\\lib\\index.js!F:\\HBuilderX软件\\Project\\brainHealth\\src\\utils\\authority.js","dependencies":[{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\src\\utils\\authority.js","mtime":1634182984000},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652884357093},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1652884357093},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\babel-loader\\lib\\index.js","mtime":1652881229298}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycy5qcyI7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJzsKaW1wb3J0ICR1dGlscyBmcm9tICdAL3V0aWxzL2luZGV4JzsKaW1wb3J0IHJvdXRlciBmcm9tICJAL3JvdXRlciI7IC8vIHRva2Vu5Yik5pat55m75b2V54q25oCB77yMdXNlcuS4gOaXpuWtmOWcqOWwseS4jeWFgeiuuOS/ruaUuQoKZXhwb3J0IHZhciB1c2VyQXV0aG9yaXR5ID0gZnVuY3Rpb24gdXNlckF1dGhvcml0eSgpIHsKICB2YXIgYmVmb3JlVG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKTsKICB2YXIgYWZ0ZXJUb2tlbiA9IG51bGw7CiAgdmFyIGJlZm9yZVVzZXIgPSBKU09OLnN0cmluZ2lmeShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaWQiKSk7CiAgdmFyIGFmdGVyVXNlciA9IG51bGw7CiAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgYWZ0ZXJUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogICAgYWZ0ZXJVc2VyID0gSlNPTi5zdHJpbmdpZnkobG9jYWxTdG9yYWdlLmdldEl0ZW0oImlkIikpOwoKICAgIGlmIChhZnRlclRva2VuICE9PSBiZWZvcmVUb2tlbikgewogICAgICBiZWZvcmVUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpOwogICAgICBzdG9yZS5jb21taXQoInNldFRva2VuIiwgSlNPTi5wYXJzZShhZnRlclRva2VuKSk7CiAgICAgICFhZnRlclRva2VuICYmIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ0b2tlbiIpOwogICAgfQoKICAgIGlmIChhZnRlclRva2VuICYmIGJlZm9yZVVzZXIgJiYgYmVmb3JlVXNlciAhPT0gYWZ0ZXJVc2VyKSB7CiAgICAgICR1dGlscy5lbE1lc3NhZ2VCb3goIuiOt+WPlueUqOaIt+S/oeaBr+Wksei0pe+8jOivt+mHjeaWsOeZu+W9lS3mnYPpmZAiLCAid2FybmluZyIpOwogICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTsKICAgICAgYmVmb3JlVXNlciA9IEpTT04uc3RyaW5naWZ5KGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJpZCIpKTsKICAgICAgcm91dGVyLmN1cnJlbnRSb3V0ZS5wYXRoICE9PSAiLyIgJiYgcm91dGVyLnB1c2goIi8iKTsKICAgIH0KICB9LCA1MDApOwogIHJldHVybiB0aW1lcjsKfTs="},{"version":3,"sources":["F:/HBuilderX软件/Project/brainHealth/src/utils/authority.js"],"names":["store","$utils","router","userAuthority","beforeToken","localStorage","getItem","afterToken","beforeUser","JSON","stringify","afterUser","timer","setInterval","commit","parse","removeItem","elMessageBox","clear","currentRoute","path","push"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,SAAlB;AACA,OAAOC,MAAP,MAAmB,eAAnB;AACA,OAAOC,MAAP,MAAmB,UAAnB,C,CAEA;;AACA,OAAO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AACjC,MAAIC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAlB;AACA,MAAIC,UAAU,GAAG,IAAjB;AACA,MAAIC,UAAU,GAAGC,IAAI,CAACC,SAAL,CAAeL,YAAY,CAACC,OAAb,CAAqB,IAArB,CAAf,CAAjB;AACA,MAAIK,SAAS,GAAG,IAAhB;AACA,MAAMC,KAAK,GAAGC,WAAW,CAAC,YAAM;AAC9BN,IAAAA,UAAU,GAAGF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAb;AACAK,IAAAA,SAAS,GAAGF,IAAI,CAACC,SAAL,CAAeL,YAAY,CAACC,OAAb,CAAqB,IAArB,CAAf,CAAZ;;AACA,QAAIC,UAAU,KAAKH,WAAnB,EAAgC;AAC9BA,MAAAA,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;AACAN,MAAAA,KAAK,CAACc,MAAN,CAAa,UAAb,EAAyBL,IAAI,CAACM,KAAL,CAAWR,UAAX,CAAzB;AACA,OAACA,UAAD,IAAeF,YAAY,CAACW,UAAb,CAAwB,OAAxB,CAAf;AACD;;AACD,QAAIT,UAAU,IAAIC,UAAd,IAA4BA,UAAU,KAAKG,SAA/C,EAA0D;AACxDV,MAAAA,MAAM,CAACgB,YAAP,CAAoB,mBAApB,EAAyC,SAAzC;AACAZ,MAAAA,YAAY,CAACa,KAAb;AACAV,MAAAA,UAAU,GAAGC,IAAI,CAACC,SAAL,CAAeL,YAAY,CAACC,OAAb,CAAqB,IAArB,CAAf,CAAb;AACAJ,MAAAA,MAAM,CAACiB,YAAP,CAAoBC,IAApB,KAA6B,GAA7B,IAAoClB,MAAM,CAACmB,IAAP,CAAY,GAAZ,CAApC;AACD;AACF,GAdwB,EActB,GAdsB,CAAzB;AAeA,SAAOT,KAAP;AACD,CArBM","sourcesContent":["import store from '@/store'\r\nimport $utils from '@/utils/index'\r\nimport router from \"@/router\"\r\n\r\n// token判断登录状态，user一旦存在就不允许修改\r\nexport const userAuthority = () => {\r\n  let beforeToken = localStorage.getItem(\"token\")\r\n  let afterToken = null\r\n  let beforeUser = JSON.stringify(localStorage.getItem(\"id\"))\r\n  let afterUser = null\r\n  const timer = setInterval(() => {\r\n    afterToken = localStorage.getItem(\"token\")\r\n    afterUser = JSON.stringify(localStorage.getItem(\"id\"))\r\n    if (afterToken !== beforeToken) {\r\n      beforeToken = localStorage.getItem(\"token\")\r\n      store.commit(\"setToken\", JSON.parse(afterToken))\r\n      !afterToken && localStorage.removeItem(\"token\")\r\n    }\r\n    if (afterToken && beforeUser && beforeUser !== afterUser) {\r\n      $utils.elMessageBox(\"获取用户信息失败，请重新登录-权限\", \"warning\")\r\n      localStorage.clear()\r\n      beforeUser = JSON.stringify(localStorage.getItem(\"id\"))\r\n      router.currentRoute.path !== \"/\" && router.push(\"/\")\r\n    }\r\n  }, 500)\r\n  return timer\r\n}"]}]}