{"remainingRequest":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\HBuilderX软件\\Project\\brainHealth\\src\\views\\user\\userCenter\\components\\uploadImg.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\src\\views\\user\\userCenter\\components\\uploadImg.vue","mtime":1634182984000},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652881228353},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\babel-loader\\lib\\index.js","mtime":1652881229298},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1652881228353},{"path":"F:\\HBuilderX软件\\Project\\brainHealth\\node_modules\\vue-loader\\lib\\index.js","mtime":1652881229590}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHVwbG9hZEF2YXRhckltZ0FwaSB9IGZyb20gIkAvYXBpL2FwaSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAidXBsb2FkSW1nIiwKICBwcm9wczogewogICAgZGlhbG9nVGFibGVWaXNpYmxlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpbWdVcmw6ICIiLAogICAgICBzaG93SW1nOiB0cnVlLAogICAgICBmaWxlZGF0YTogIiIsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgY2xvc2VDbGljaygpIHsKICAgICAgdGhpcy4kZW1pdCgiY2xvc2VVcGxvYWRJbWciLCBmYWxzZSk7CiAgICB9LAogICAgZ2V0RmlsZShmaWxlKSB7CiAgICAgIHRoaXMuJHV0aWxzLmdldEJhc2U2NChmaWxlKS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICB0aGlzLnNob3dJbWcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuaW1nVXJsID0gcmVzOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g6KaG55uW6buY6K6k55qE5LiK5Lyg6KGM5Li677yM5Y+v5Lul6Ieq5a6a5LmJ5LiK5Lyg55qE5a6e546wCiAgICBoYW5kbGVVcGxvYWQocmVzKSB7CiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoImF2YXRhciIsIHJlcy5maWxlKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCJpZCIsIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0VXNlci5faWQpOwogICAgICB0aGlzLmZpbGVkYXRhID0gZm9ybURhdGE7CiAgICAgIHRoaXMuZ2V0RmlsZShyZXMuZmlsZSk7CiAgICB9LAogICAgLy/lj5bmtojkuIrkvKAKICAgIGNhbmNlbFVwbG9hZCgpIHsKICAgICAgdGhpcy5zaG93SW1nID0gdHJ1ZTsKICAgICAgdGhpcy5pbWdVcmwgPSAiIjsKICAgIH0sCiAgICAvL+ehruiupOS4iuS8oAogICAgYXN5bmMgY29uZmlybVVwbG9hZCgpIHsKICAgICAgbGV0IHJlcyA9IGF3YWl0IHVwbG9hZEF2YXRhckltZ0FwaSh0aGlzLmZpbGVkYXRhKTsKICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsKICAgICAgICB0aGlzLiR1dGlscy5lbE1lc3NhZ2VCb3goIuabtOaNouWktOWDj+aIkOWKnyIsICJzdWNjZXNzIik7CiAgICAgIH0KICAgICAgdGhpcy5jbG9zZUNsaWNrKCk7CiAgICAgIHRoaXMuJGVtaXQoInVwZGF0ZUltZyIpOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["uploadImg.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"uploadImg.vue","sourceRoot":"src/views/user/userCenter/components","sourcesContent":["<template>\n  <div class=\"upload-box\">\n    <el-dialog title=\"更换头像\" @close=\"closeClick\" :visible=\"true\" :close-on-click-modal=\"false\" align=\"center\" width=\"800px\">\n      <el-upload class=\"upload-demo\" :http-request=\"handleUpload\" action :limit=\"1\" :show-file-list=\"false\" drag v-if=\"showImg\">\n        <i class=\"el-icon-upload\"></i>\n        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n        <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过1M</div>\n      </el-upload>\n      <div v-else class=\"img-box\">\n        <img :src=\"imgUrl\" alt=\"\" />\n        <div class=\"btn-box\">\n          <el-button type=\"info\" plain @click=\"cancelUpload\">取消</el-button>\n          <el-button type=\"danger\" plain @click=\"confirmUpload\">上传并保存</el-button>\n        </div>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { uploadAvatarImgApi } from \"@/api/api\";\nexport default {\n  name: \"uploadImg\",\n  props: {\n    dialogTableVisible: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      imgUrl: \"\",\n      showImg: true,\n      filedata: \"\",\n    };\n  },\n  methods: {\n    closeClick() {\n      this.$emit(\"closeUploadImg\", false);\n    },\n    getFile(file) {\n      this.$utils.getBase64(file).then((res) => {\n        if (res) {\n          this.showImg = false;\n          this.imgUrl = res;\n        }\n      });\n    },\n    // 覆盖默认的上传行为，可以自定义上传的实现\n    handleUpload(res) {\n      let formData = new FormData();\n      formData.append(\"avatar\", res.file);\n      formData.append(\"id\", this.$store.getters.getUser._id);\n      this.filedata = formData;\n      this.getFile(res.file);\n    },\n    //取消上传\n    cancelUpload() {\n      this.showImg = true;\n      this.imgUrl = \"\";\n    },\n    //确认上传\n    async confirmUpload() {\n      let res = await uploadAvatarImgApi(this.filedata);\n      console.log(res);\n      if (res.code === 200) {\n        this.$utils.elMessageBox(\"更换头像成功\", \"success\");\n      }\n      this.closeClick();\n      this.$emit(\"updateImg\");\n    },\n  },\n};\n</script>\n\n<style scoped>\n.img-box {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.img-box > img {\n  width: 240px;\n  height: 240px;\n  border-radius: 50%;\n}\n.btn-box {\n  margin-top: 30px;\n  width: 200px;\n  display: flex;\n  justify-content: space-between;\n}\n.el-upload__tip {\n  font-size: 16px;\n}\n.el-upload__text {\n  font-size: 16px;\n}\n</style>"]}]}